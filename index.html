<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prayer Times</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f8f8f8;
            padding: 20px;
        }
        .card {
            background: white;
            padding: 20px;
            margin: 20px auto;
            width: 80%;
            max-width: 400px;
            border-radius: 10px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #D4AF37;
        }
        .time {
            font-size: 24px;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <h1>Prayer Times</h1>

    <div class="card">
        <h2>Next Prayer: <span id="next-prayer">Loading...</span></h2>
        <p>Time left: <span id="countdown">--:--</span></p>
    </div>

    <script>
        // Adjusting to get the prayer times from the API
        async function getPrayerTimes() {
            const country = "Iraq"; // Country
            const city = "Duhok"; // City
            const apiUrl = `http://api.aladhan.com/v1/timingsByCity?city=${city}&country=${country}&method=2`; 

            const response = await fetch(apiUrl);
            const data = await response.json();
            
            // Get prayer times
            const timings = data.data.timings;

            // Get the current time
            const currentTime = new Date();
            const currentHour = currentTime.getHours();
            const currentMinute = currentTime.getMinutes();

            // Function to format the time into HH:MM
            function formatTime(hour, minute) {
                return `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
            }

            // Function to find the next prayer
            function getNextPrayer(timings, currentHour, currentMinute) {
                const prayers = [
                    { name: "Fajr", time: timings.Fajr },
                    { name: "Sunrise", time: timings.Sunrise },
                    { name: "Dhuhr", time: timings.Dhuhr },
                    { name: "Asr", time: timings.Asr },
                    { name: "Maghrib", time: timings.Maghrib },
                    { name: "Isha", time: timings.Isha }
                ];

                let nextPrayer = null;
                let minTimeDifference = Number.MAX_VALUE;

                // Loop through prayer times and find the next prayer
                prayers.forEach(prayer => {
                    const [hour, minute] = prayer.time.split(":");
                    const prayerTime = new Date();
                    prayerTime.setHours(hour, minute, 0, 0);

                    const timeDifference = prayerTime - currentTime;
                    if (timeDifference > 0 && timeDifference < minTimeDifference) {
                        minTimeDifference = timeDifference;
                        nextPrayer = prayer;
                    }
                });

                return nextPrayer;
            }

            const nextPrayer = getNextPrayer(timings, currentHour, currentMinute);

            // Update the next prayer name and countdown
            if (nextPrayer) {
                document.getElementById("next-prayer").textContent = nextPrayer.name;
                const nextPrayerTime = nextPrayer.time.split(":");
                const nextPrayerHour = parseInt(nextPrayerTime[0], 10);
                const nextPrayerMinute = parseInt(nextPrayerTime[1], 10);

                const timeLeft = new Date();
                timeLeft.setHours(nextPrayerHour, nextPrayerMinute, 0, 0);
                const diff = timeLeft - currentTime;

                if (diff > 0) {
                    const diffHours = Math.floor(diff / (1000 * 60 * 60));
                    const diffMinutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    document.getElementById("countdown").textContent = `${diffHours}:${diffMinutes.toString().padStart(2, '0')}`;
                }
            }
        }

        // Get prayer times when the page loads
        window.onload = getPrayerTimes;
    </script>
</body>
</html>
